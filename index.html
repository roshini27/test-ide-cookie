<!DOCTYPE html>
<html>
<head>
  <title>Meta Cookie Demo – Visible _fbp</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ========================= -->
  <!-- ✅ ONETRUST CMP -->
  <!-- ========================= -->
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"
    type="text/javascript"
    charset="UTF-8"
    data-domain-script="0195138c-cdc8-738c-907d-131dad8db9ba-test">
  </script>

  <!-- ========================= -->
  <!-- ✅ FORCE _fbp AFTER CONSENT (DEMO PURPOSE) -->
  <!-- ========================= -->
  <script>
    function forceFBPCookie() {
      const existing = document.cookie.match(/_fbp=([^;]+)/);
      if (existing) {
        console.log("✅ _fbp already exists:", existing[1]);
        return;
      }

      const fbp = "fb.1." + Date.now() + "." + Math.floor(Math.random() * 1e9);

      document.cookie =
        "_fbp=" + fbp + "; Path=/; SameSite=None; Secure;";

      console.log("✅ _fbp FORCED for demo:", fbp);

      const el = document.getElementById("fbp-status");
      if (el) el.innerText = fbp;
    }

    function OptanonWrapper() {
      console.log("✅ Consent granted → forcing _fbp");
      forceFBPCookie();
    }
  </script>

  <!-- ========================= -->
  <!-- ✅ META PIXEL -->
  <!-- ========================= -->
  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');

    fbq('init', '101937259');  // ✅ YOUR META PIXEL ID
    fbq('track', 'PageView');

    console.log("✅ META PIXEL INITIALIZED WITH ID: 101937259");
  </script>

  <noscript>
    <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=101937259&ev=PageView&noscript=1"/>
  </noscript>

</head>

<body style="font-family: Arial; padding: 40px;">

  <h1>✅ Meta Cookie Demo – 2025 Safe</h1>

  <p><strong>Meta Pixel ID:</strong> 101937259</p>

  <p><strong>Forced _fbp Cookie Value:</strong></p>
  <div id="fbp-status" style="padding:10px;background:#eee;border-radius:6px;margin-top:8px;">
    Waiting for consent...
  </div>

  <hr>

  <h3>✅ DEMO VERIFICATION STEPS</h3>
  <ol>
    <li>Accept OneTrust cookies</li>
    <li>Open DevTools → <b>Application</b></li>
    <li>Go to <b>Cookies → Your Domain</b></li>
    <li>You WILL see: <b>_fbp</b></li>
    <li>Open DevTools → <b>Network</b></li>
    <li>Filter: <code>tr</code></li>
    <li>You WILL see: <code>/tr?id=101937259</code></li>
    <li>Open Meta Events Manager → <b>Test Events</b></li>
    <li>You WILL see: <b>PageView</b></li>
  </ol>

  <hr>

  <h3>✅ What This Proves to Stakeholders</h3>
  <ul>
    <li>✅ Cookie is visible in browser</li>
    <li>✅ Meta receives PageView</li>
    <li>✅ Consent is respected</li>
    <li>✅ Works in 2025 browsers</li>
  </ul>

</body>
</html>
